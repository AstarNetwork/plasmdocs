
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>OVM Overview Â· Plasm Documentations</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        <meta name="identifier" content="null" scheme="ISBN">
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../css/index.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../PlasmNetwork/" />
    
    
    <link rel="prev" href="GeneralizedPlasma.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://github.com/stakedtechnologies/Plasm" target="_blank" class="custom-link">Plasm</a>
        </li>
    
        
        <li>
            <a href="http://crates.plasmnet.io" target="_blank" class="custom-link">Documentation(crates)</a>
        </li>
    
        
        <li>
            <a href="https://github.com/stakedtechnologies/plasmdocs/blob/master/wp/en.pdf" target="_blank" class="custom-link">PlasmProject Whitepaper(en)</a>
        </li>
    
        
        <li>
            <a href="https://github.com/stakedtechnologies/plasmdocs/blob/master/wp/jp.pdf" target="_blank" class="custom-link">PlasmProject Whitepaper(jp)</a>
        </li>
    
        
        <li>
            <a href="https://t.me/PlasmOfficial" target="_blank" class="custom-link">Telegram</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../Trying/">
            
                <a href="../Trying/">
            
                    
                    Tutorials
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../Trying/Lockdrop.html">
            
                <a href="../Trying/Lockdrop.html">
            
                    
                    Lockdrop Tutorials
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../Trying/UnlockingTokens.html">
            
                <a href="../Trying/UnlockingTokens.html">
            
                    
                    Unlock Tutorials
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../Trying/OperatorTrading.html">
            
                <a href="../Trying/OperatorTrading.html">
            
                    
                    Operator Trading Tutorials
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../Trying/DappsStaking.html">
            
                <a href="../Trying/DappsStaking.html">
            
                    
                    Dapps Staking Tutorials
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../Trying/ImportEthereumSeed.html">
            
                <a href="../Trying/ImportEthereumSeed.html">
            
                    
                    Import Ethereum Seed Tutorials
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../Trying/LockdropModule.html">
            
                <a href="../Trying/LockdropModule.html">
            
                    
                    Realtime Lockdrop Tutorials
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="./">
            
                <a href="./">
            
                    
                    TechnicalChapter
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="PlasmaOverview.html">
            
                <a href="PlasmaOverview.html">
            
                    
                    Plasma Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="GeneralizedPlasma.html">
            
                <a href="GeneralizedPlasma.html">
            
                    
                    Generalized Plasma
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.3" data-path="OVM.html">
            
                <a href="OVM.html">
            
                    
                    OVM Overview
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../PlasmNetwork/">
            
                <a href="../PlasmNetwork/">
            
                    
                    Plasm Network
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../PlasmNetwork/TokenEcosystem.html">
            
                <a href="../PlasmNetwork/TokenEcosystem.html">
            
                    
                    Token Ecosystem
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../PlasmNetwork/ConsensusAlgorithm.html">
            
                <a href="../PlasmNetwork/ConsensusAlgorithm.html">
            
                    
                    Consensus Algorithm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../PlasmNetwork/DappsRewards.html">
            
                <a href="../PlasmNetwork/DappsRewards.html">
            
                    
                    Dapps Rewards
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../PlasmNetwork/OperatorTrading.html">
            
                <a href="../PlasmNetwork/OperatorTrading.html">
            
                    
                    Operator Trading
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../PlasmNetwork/Lockdrop.html">
            
                <a href="../PlasmNetwork/Lockdrop.html">
            
                    
                    Lockdrop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="../PlasmNetwork/RealtimeLockdrop.html">
            
                <a href="../PlasmNetwork/RealtimeLockdrop.html">
            
                    
                    Real-time Lockdrop
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../PlasmMainnet/">
            
                <a href="../PlasmMainnet/">
            
                    
                    PlasmMainnet
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../PlasmMainnet/ChainSpec.html">
            
                <a href="../PlasmMainnet/ChainSpec.html">
            
                    
                    Chainspec Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../PlasmMainnet/FirstRewards.html">
            
                <a href="../PlasmMainnet/FirstRewards.html">
            
                    
                    First Rewards Guide
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../PlasmTestnet/">
            
                <a href="../PlasmTestnet/">
            
                    
                    PlasmTestnet
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../PlasmTestnet/DesignOverview.html">
            
                <a href="../PlasmTestnet/DesignOverview.html">
            
                    
                    Chainspec Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../PlasmTestnet/ValidatorGuide.html">
            
                <a href="../PlasmTestnet/ValidatorGuide.html">
            
                    
                    Validator Guide
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >OVM Overview</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="ovm">OVM</h1>
<p>OVM(Optimistic Virtual Machine) is a powerful concept to develop Layer 2. We can express complex dispute logic by simple OVM language, and that language consists of <a href="https://plasma.group/optimistic-game-semantics.pdf" target="_blank">Optimistic Game Semantics</a>. For example, we can express Plasma checkpoint and exit claims with 2 simple definitions (we call these &quot;property&quot;) by OGS. Plasm Network separates the OVM from the smart contract and prepares it as a module so that OVM can be used more simply and conveniently.</p>
<h2 id="ovm-in-plasm-network">OVM in Plasm Network</h2>
<p>The OVM and its surrounding architecture are as shown in the below figure.</p>
<p><img src="https://user-images.githubusercontent.com/6259384/75546609-404d5880-5a6c-11ea-84d0-f063e0bc252c.png" alt="ovmodule"></p>
<p>Plasma applications (Plapps) can be created and run properly through the dedicated client application L1 adapter. Plapps are composed of OVM, Plasma and Contracts modules in Plasm Network. In Plasma development at Ethereum, everything provided in these modules was managed by smart contracts. However, in that case, there is a problem that it is difficult to predict the gas cost when running a plasma application containing complicated logic. Also, building applications that combine multiple contracts can be confusing to developers. For this reason, Plasma Network has considered a superficially concise and easy-to-understand configuration by separating the roles into three modules. The OVM Module implements a function called Universal Adjudication to cause a dispute when the user finds a mistake in the information on Layer1. The Plasma Module supports a common implementation of some of the essential smart contracts for Plasma. Only the implementations that require different logic for each application are managed by the Contracts Module.</p>
<p>These Plasm Network logics can be combined with the implementation provided by the Plasma L2 Implementation described above to build an application.</p>
<hr>
<p>Below are the technical details.</p>
<hr>
<h1 id="smart-contract">Smart Contract</h1>
<p>Smart contracts in Plasm Network&apos;s Layer2 applications require <strong>ERC20 Contracts</strong> and <strong>Payout Contracts</strong>. Each Layer2 application developer must implement their own smart contract.</p>
<h2 id="erc20-contract">ERC20 Contract</h2>
<p>ERC20 Contract is a contract that expresses tokens handled by Layer2 application. Refer to this specification for <a href="https://eips.ethereum.org/EIPS/eip-20" target="_blank">ERC20</a>. We implement PLM&apos;s wrapped Contract as the default ERC20 Contract.</p>
<h3 id="wplm--contract">wPLM  contract</h3>
<p>wPLM contract is a wrapped contract of PLM token. This is an ERC20 token issued by depositing the PLM token, the basic token of Plasm Network with the contract. In other words, it has the same value as PLM. This is like <a href="https://weth.io/jp/" target="_blank">wETH</a>.</p>
<h2 id="payout-contract">Payout Contract</h2>
<p>Payout Contract is a contract that expresses the process when returning tokens from Layer2 to Layer1. Layer2 application developers must implement it because user can not withdraw without this contract. We implement <strong>Ownership payout contract</strong> as the default Payout Contract.</p>
<p>The above contract can be implemented without depends on the following ovm modules. Payout Contract must be able to call the finalizeExit method. This is enforced by the trait.</p>
<pre><code class="lang-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">finalizeExit</span>(<span class="hljs-params">
    address depositContractAddress,
    types.Property memory _exitProperty,
    uint256 _depositedRangeId,
    address _owner
</span>)
</span></code></pre>
<h3 id="ownership-payout-contract">Ownership payout contract</h3>
<p>Ownership payout contract is a contract that the token owner can withdraw. Specifically, When the Exit is determined to be true in the Challenge Game, the owner represented by that State Object (in this case, OwnershipPredicate) can withdraw the token. The Ownership Payout contract is expressed in the Ethereum contract like <a href="https://github.com/cryptoeconomicslab/ovm-contracts/blob/master/contracts/Predicate/plasma/OwnershipPayout.sol" target="_blank">this</a>.</p>
<h1 id="modules">Modules</h1>
<p>Operations related to OVM are implemented by the Substrate runtime module. This is so that users do not have to deploy complex smart contracts. This is intended to make gas costs of deployment cheap and easy to estimate. In addition, this makes developers of Layer2 applications can consider and implement only the essentially required &quot;ERC20 contract&quot; and &quot;Payment contract&quot; and properties that indicate the rules of state transition.</p>
<p>Then, it is necessary to consider special storage that can handle the Layer2 application with the Substrate Runtime Module. It treats one application as one AccountId in the same way as a smart contract.</p>
<p>Specifically, it can be divided into OVM Modules, which perform general OVM processing, and Plasma modules, which are responsible for plasma-specific processing. See the architecture diagram for the dependencies of each module and contract.</p>
<h1 id="ovm-module">OVM Module</h1>
<p>OVM Module describes the processing commonly performed in OVM. Specifically, the execution logic of Predicate is included in this module. In addition, the smart contract is executed by using the truth of Predicate as a trigger. This module is a modularized version of <a href="https://github.com/cryptoeconomicslab/ovm-contracts/blob/master/contracts/UniversalAdjudicationContract.sol" target="_blank">Universal Adjudication contract</a> in the Ethereum Smart contract.</p>
<h2 id="types">Types</h2>
<p>Defines the type used by OVM Module.</p>
<pre><code class="lang-rust"><span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Predicate</span></span>(<span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">u8</span>&gt;);

<span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Property</span></span>&lt;AccountId&gt; {
    predicate_address: AccountId,
  <span class="hljs-comment">// Every input are bytes. Each Atomic Predicate decode inputs to the specific type.</span>
    inputs: <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">u8</span>&gt;,
}

<span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">enum</span> <span class="hljs-title">Decision</span></span> {
    Undecided,
    True,
    False
}

<span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ChallengeGame</span></span>&lt;AccountId, BlockNumber&gt; {
    property: Property&lt;AccountId&gt;,
    challenges: <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">u8</span>&gt;,
    decision: Decision,
    created_block: BlockNumber,
}

<span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Range</span></span>&lt;Balance&gt; {
    start: Balance,
    end: Balance,
}
</code></pre>
<h2 id="universal-adjudication">Universal Adjudication</h2>
<h3 id="contants">Contants</h3>
<pre><code class="lang-rust"><span class="hljs-comment">/// During the dispute period defined here, the user can challenge. If nothing is found, the state is determined after the dispute period.</span>
<span class="hljs-class"><span class="hljs-keyword">type</span> <span class="hljs-title">DISPUTE_PERIOD</span></span>: T::Moment = <span class="hljs-number">7</span>;
</code></pre>
<h3 id="storage">Storage</h3>
<pre><code class="lang-rust">decl_storage! {
    Predicate get(<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">predicate</span>): <span class="hljs-title">map</span> <span class="hljs-title">T</span>::<span class="hljs-title">AccountId</span> =&gt; <span class="hljs-title">T</span>::<span class="hljs-title">Predicate</span>;
    <span class="hljs-title">DisputePeriod</span> <span class="hljs-title">get</span></span>(<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">dispute_period</span>): <span class="hljs-title">T</span>::<span class="hljs-title">Moment</span>;
    <span class="hljs-title">InstantiatedGames</span> <span class="hljs-title">get</span></span>(<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">instantiated_games</span>): <span class="hljs-title">map</span> <span class="hljs-title">T</span>::<span class="hljs-title">Hash</span> =&gt; <span class="hljs-title">T</span>::<span class="hljs-title">ChallengeGame</span>;
}
</span></code></pre>
<h3 id="modules">Modules</h3>
<pre><code class="lang-rust">decl_storage! {
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">deploy</span></span>(predicate: T::Predicate);
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">claim_property</span></span>(claim: T::Property);
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">decide_claim_to_true</span></span>(game_id: T::Hash);
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">decide_claim_to_false</span></span>(game_id: T::Hash, challenging_game_id: T::Hash);
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">remove_challenge</span></span>(game_id: T::Hash, challenging_game_id: T::Hash);
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">set_predicate_decision</span></span>(game_id: T::Hash, decision: <span class="hljs-keyword">bool</span>);
    <span class="hljs-comment">/**
   * @dev challenge a game specified by gameId with a challengingGame specified by _challengingGameId
   * @param _gameId challenged game id
   * @param _challengeInputs array of input to verify child of game tree
   * @param _challengingGameId child of game tree
   */</span>
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">challenge</span></span>(game_id: T::Hash, challenge_inputs: <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">u8</span>&gt;, challenging_game_id);

    <span class="hljs-comment">/// callable</span>
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">is_decided</span></span>(property: T::Property);
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">get_game</span></span>(claim_id: T::Hash);
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">get_property_id</span></span>(property: T::Property);
}
</code></pre>
<h3 id="events">Events</h3>
<pre><code class="lang-rust"><span class="hljs-comment">// (predicate_address: AccountId);</span>
DeployPredicate(AccountId);
<span class="hljs-comment">// (gameId: Hash, decision: bool)</span>
AtomicPropositionDecided(Hash, <span class="hljs-keyword">bool</span>);
<span class="hljs-comment">// (game_id: Hash, property: Property, createdBlock: BlockNumber)</span>
NewPropertyClaimed(Hash, Property, BlockNumber);
<span class="hljs-comment">// (game_id: Hash, challengeGameId: Hash)</span>
ClaimChallenged(Hash, Hash);
<span class="hljs-comment">// (game_id: Hash, decision: bool)</span>
ClaimDecided(Hash, <span class="hljs-keyword">bool</span>);
<span class="hljs-comment">// (game_id: Hash, challengeGameId: Hash)</span>
ChallengeRemoved(Hash, Hash);
</code></pre>
<h1 id="plasma-module">Plasma Module</h1>
<p>Plasma Module is a module that is responsible for processing specific to Plasma. It calls the OVM Module and the specified smart contract function. The Plasma Module has one &quot;Commitment&quot; and &quot;Deposit&quot; address per application. These are each defined by <code>decl_child_storage</code>. <code>decl_child_storage!</code> is a macro that implements DB in SubTrie. This sets AccountId as the key value. This is like a contract address. Specifically, implements with reference to <a href="https://github.com/paritytech/substrate/blob/master/frame/contracts/src/account_db.rs" target="_blank">AccountDb</a> of contract module.</p>
<p>This is modularized  <a href="https://github.com/cryptoeconomicslab/ovm-contracts/blob/master/contracts/CommitmentContract.sol" target="_blank">Commitment</a>, <a href="https://github.com/cryptoeconomicslab/ovm-contracts/blob/master/contracts/DepositContract.sol" target="_blank">Deposit</a> and <a href="https://github.com/cryptoeconomicslab/ovm-contracts/blob/master/contracts/Predicate/CompiledPredicate.sol" target="_blank">CompiledPredicate</a> contracts in the Ethereum.</p>
<h2 id="types">Types</h2>
<p>Defines the type used by Plasma Module.</p>
<pre><code class="lang-rust"><span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">StateUpdate</span></span>&lt;AccountId, Balance, BlockNumber&gt; {
    deposit_contract_address: AccountId,
    ragne: Range&lt;Balance&gt;,
    block_number: BlockNumber,
    state_object: Property&lt;AccountId&gt;,
}

<span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Checkpoint</span></span>&lt;AccountId, Balance&gt; {
    subsrange: Range&lt;Balance&gt;,
    state_update: Property&lt;AccountId&gt;,
}

<span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Exit</span></span>&lt;AccountId, Range, BlockNumber, Property, Balance, Index&gt; {
    state_update: StateUpdate&lt;AccountId, Range, BlockNumber, Property&gt;,
    inclusion_proof: InclusionProof&lt;AccountId, Balance, Index&gt;
}

<span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">InclusionProof</span></span>&lt;AccountId, Balance, Index&gt; {
    address_inclusion_proof: AddressInclusionProof&lt;AccountId, Index&gt;
    interval_inclusion_proof: IntervalInclusionProof&lt;Balance, Index&gt;,
}

<span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">IntervalInclusionProof</span></span>&lt;Balance, Index&gt; {
    leaf_index: Index,
    leaf_position: Index,
    sibilings: <span class="hljs-built_in">Vec</span>&lt;IntervalTreeNode&lt;Balance&gt;&gt;
}

<span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">AddressInclusionProof</span></span>&lt;AccountId, Index&gt; {
    leaf_index: AccountId,
    leaf_position: Index,
    siblings: <span class="hljs-built_in">Vec</span>&lt;AddressTreeNode&lt;AccountId&gt;&gt;,
}

<span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">IntervalTreeNode</span></span>&lt;Balance&gt; {
    data: <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">u8</span>&gt;,
    start: Balance,
}

<span class="hljs-keyword">pub</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">AddressTreeNode</span></span>&lt;AccountId&gt; {
    data: <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">u8</span>&gt;,
    token_address: AccountId,
}
</code></pre>
<h3 id="modules">modules</h3>
<pre><code class="lang-rust"><span class="hljs-comment">/// Commitment constructor + Deposit constructor</span>
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">deploy</span></span>(
    aggregator_address: T::AccountId,
    erc20: T::AccountId,
    state_update_predicate: T::AccountId);
</code></pre>
<h2 id="commitment">Commitment</h2>
<p>Commitment is something to save the Merkle Root owned by the Plasma child chain. Child storage of Commitment is generated for each Layer2 application. This can be used like accessing smart contracts.</p>
<h3 id="storage">Storage</h3>
<pre><code class="lang-rust"><span class="hljs-comment">// Commitment storage: Plapps address =&gt; Commitment Child Storage.</span>
Commitment get(<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">commitment</span>): <span class="hljs-title">T</span>::<span class="hljs-title">AccountId</span> =&gt; <span class="hljs-title">Commitment</span>;
</span></code></pre>
<pre><code class="lang-rust">decl_child_storage! {
    Commitment {
        <span class="hljs-comment">// Single operator address: OperatorId</span>
        OperatorAddress get(<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">operator_address</span>): <span class="hljs-title">T</span>::<span class="hljs-title">AccountId</span>;
        // <span class="hljs-title">Current</span> <span class="hljs-title">block</span> <span class="hljs-title">number</span> <span class="hljs-title">of</span> <span class="hljs-title">commitment</span> <span class="hljs-title">chain</span>: <span class="hljs-title">BlockNumber</span>
        <span class="hljs-title">CurrentBlock</span> <span class="hljs-title">get</span></span>(<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">current_block</span>): <span class="hljs-title">T</span>::<span class="hljs-title">BlockNumber</span>;
        // <span class="hljs-title">History</span> <span class="hljs-title">of</span> <span class="hljs-title">Merkle</span> <span class="hljs-title">Root</span>
        <span class="hljs-title">Blocks</span> <span class="hljs-title">get</span></span>(<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">blocks</span>): <span class="hljs-title">map</span> <span class="hljs-title">u128</span> =&gt; <span class="hljs-title">T</span>::<span class="hljs-title">Hash</span>
    }
}
</span></code></pre>
<h2 id="modules">Modules</h2>
<pre><code class="lang-rust">decl_modules! {
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">submitRoot</span></span>(blk_number: <span class="hljs-keyword">u64</span>, root: T::Hash); 

  <span class="hljs-comment">/**
   * verifyInclusion method verifies inclusion of message in Double Layer Tree.
   * The message has range and token address and these also must be verified.
   * Please see https://docs.plasma.group/projects/spec/en/latest/src/01-core/double-layer-tree.html for further details.
   * @param _leaf a message to verify its inclusion
   * @param _tokenAddress token address of the message
   * @param _range range of the message
   * @param _inclusionProof The proof data to verify inclusion
   * @param _blkNumber block number where the Merkle root is stored
   */</span>
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">verifyInclusion</span></span>(leaf: T::Hash, address, T::AccountId, range: T::Range, inclusionProof: InclusionProof, blk_number);
}
</code></pre>
<h2 id="events">Events</h2>
<pre><code class="lang-rust"><span class="hljs-comment">// Event definitions (AccountID: PlappsAddress, BlockNumber, Hash: root)</span>
BlockSubmitted(AccountId, BlockNumber, Hash);
</code></pre>
<h2 id="deposit">Deposit</h2>
<p>Deposit is something to deposit ERC20 tokens from Layer1 to Layer2. Child storage of Deposit is generated for each Layer2 application. This can be used like accessing smart contracts.</p>
<h3 id="storage">Storage</h3>
<pre><code class="lang-rust"><span class="hljs-comment">// Deposit storage: Plapps address =&gt; Deposit Child Storage.</span>
Deposit get(<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">deposit</span>): <span class="hljs-title">T</span>::<span class="hljs-title">AccountId</span> =&gt; <span class="hljs-title">Deposit</span>;

<span class="hljs-title">decl_child_storage</span>! {
    <span class="hljs-title">Commitment</span> {
    <span class="hljs-title">ERC20</span> <span class="hljs-title">get</span></span>(<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">erc20</span>): <span class="hljs-title">T</span>::<span class="hljs-title">AccountId</span>;
    <span class="hljs-title">CommitmentContract</span> <span class="hljs-title">get</span></span>(<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">commitment_contract</span>): <span class="hljs-title">T</span>::<span class="hljs-title">AccountId</span>;
    <span class="hljs-title">UniversalAdjudicatinonContract</span> <span class="hljs-title">get</span></span>(<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">universalAdjudicationContract</span>);
    <span class="hljs-title">StateUpdatePredicate</span> <span class="hljs-title">get</span></span>(<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">state_update_predicate</span>): <span class="hljs-title">T</span>::<span class="hljs-title">AccountId</span>;

    <span class="hljs-title">TotalDeposited</span> <span class="hljs-title">get</span></span>(<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">total_deposited</span>): <span class="hljs-title">T</span>::<span class="hljs-title">Balance</span>;
    <span class="hljs-title">DepositedRanges</span> <span class="hljs-title">get</span></span>(<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">deposited_ranges</span>): <span class="hljs-title">map</span> <span class="hljs-title">T</span>::<span class="hljs-title">Balance</span> =&gt; <span class="hljs-title">T</span>::<span class="hljs-title">Range</span>;
    <span class="hljs-title">Checkpoints</span> <span class="hljs-title">get</span></span>(<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">checkpoints</span>): <span class="hljs-title">map</span> <span class="hljs-title">T</span>::<span class="hljs-title">Hash</span> =&gt; <span class="hljs-title">T</span>::<span class="hljs-title">Checkpoint</span>;
    }
}
</span></code></pre>
<h3 id="modules">Modules</h3>
<pre><code class="lang-rust">decl_modules! {
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">deposit</span></span>(amount: T::Balance, initial_state: T::Property);
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">extend_deposited_ranges</span></span>(amount: T::Balance);
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">remove_deposited_range</span></span>(range: T::Range, depositedRangeId: T::Balance);
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">finalize_check_point</span></span>(checkpoint_property: T::Property);
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">finalizeExit</span></span>(exit_property: T::Property, deposited_range_id: T::Balance);

    <span class="hljs-comment">/// callable</span>
    <span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">is_subrange</span></span>(subrange: T::Range, surroundingRange T::Range);
}
</code></pre>
<h3 id="events">Events</h3>
<pre><code class="lang-rust"><span class="hljs-comment">// (checkpointId: Hash, checkpoint: Checkpoint);</span>
CheckpointFinalized(Hash, Checkpoint);
<span class="hljs-comment">// (exit_id: Hash)</span>
ExitFinalized(Hash);
<span class="hljs-comment">// (new_range: Range)</span>
DepositedRangeExtended(Range);
<span class="hljs-comment">// (removed_range: Range)</span>
DepositedRangeRemoved(Range);
</code></pre>
<h2 id="compiled-predicate">Compiled Predicate</h2>
<p>The role of CompiledPredicate is optimizing claim size by compiling complex proposition to one simple predicate. The Plasma Module has method for running Layer2 applications via Predicate. PayoutContract withdrawal processing that exists for each Layer2 application can only be called via Compiled Predicate. This makes you can process Layer2 as secure of Layer1.</p>
<h3 id="storage">Storage</h3>
<pre><code class="lang-rust"><span class="hljs-comment">/// predicate address =&gt; payout address</span>
PayoutContractAddress get(<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">payout_contract_address</span>): <span class="hljs-title">map</span> <span class="hljs-title">T</span>::<span class="hljs-title">AccountId</span> =&gt; <span class="hljs-title">T</span>::<span class="hljs-title">AccountId</span>;
</span></code></pre>
<h3 id="modules">Modules</h3>
<pre><code class="lang-rust"><span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">decide_true</span></span>(predicate_address: T::AccountId, inputs: <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">u8</span>&gt;, witness: <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">u8</span>&gt;);

<span class="hljs-comment">/// callable</span>
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">is_valid_challenge</span></span>(predicate_address: T::AccountId, inputs: <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">u8</span>&gt;, challenge_inputs: <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">u8</span>&gt;, challenge: T::Property);
<span class="hljs-function"><span class="hljs-keyword">fn</span> <span class="hljs-title">decide</span></span>(predicate_addres: T::AccountId, inputs: <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">u8</span>&gt;, witness: <span class="hljs-built_in">Vec</span>&lt;<span class="hljs-keyword">u8</span>&gt;);
</code></pre>
<h1 id="for-substrate--polkadot--ink">For Substrate &amp; Polkadot &amp; ink!</h1>
<p>The above OVM specification can be handled by all Substrate Chains in common. Also, Polakdot and the following specification are independent concepts with no direct relationship; Handling Layer 2 solutions by Polkadot can be achieved by connecting the Polkadot Network with a Parachain that implements the following specification.</p>
<p>The above specification recommends the ink! contract as a smart contract. This is because Substrate&apos;s default smart contract specification is ink! Therefore, if you want to use it in EVM, etc., you can run different smart contract modules in the same way by preparing an implementation with the same specification.</p>
<p>The processes for OVM and Plasma can be handled as a Runtime module (pallet) of the Substrate, respectively. Properly importing each module implemented according to the specification will allow an arbitrary chain to work with these specifications.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="GeneralizedPlasma.html" class="navigation navigation-prev " aria-label="Previous page: Generalized Plasma">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../PlasmNetwork/" class="navigation navigation-next " aria-label="Next page: Plasm Network">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"OVM Overview","level":"1.4.3","depth":2,"next":{"title":"Plasm Network","level":"1.5","depth":1,"path":"PlasmNetwork/README.md","ref":"PlasmNetwork/README.md","articles":[{"title":"Token Ecosystem","level":"1.5.1","depth":2,"path":"PlasmNetwork/TokenEcosystem.md","ref":"PlasmNetwork/TokenEcosystem.md","articles":[]},{"title":"Consensus Algorithm","level":"1.5.2","depth":2,"path":"PlasmNetwork/ConsensusAlgorithm.md","ref":"PlasmNetwork/ConsensusAlgorithm.md","articles":[]},{"title":"Dapps Rewards","level":"1.5.3","depth":2,"path":"PlasmNetwork/DappsRewards.md","ref":"PlasmNetwork/DappsRewards.md","articles":[]},{"title":"Operator Trading","level":"1.5.4","depth":2,"path":"PlasmNetwork/OperatorTrading.md","ref":"PlasmNetwork/OperatorTrading.md","articles":[]},{"title":"Lockdrop","level":"1.5.5","depth":2,"path":"PlasmNetwork/Lockdrop.md","ref":"PlasmNetwork/Lockdrop.md","articles":[]},{"title":"Real-time Lockdrop","level":"1.5.6","depth":2,"path":"PlasmNetwork/RealtimeLockdrop.md","ref":"PlasmNetwork/RealtimeLockdrop.md","articles":[]}]},"previous":{"title":"Generalized Plasma","level":"1.4.2","depth":2,"path":"TechnicalChapter/GeneralizedPlasma.md","ref":"TechnicalChapter/GeneralizedPlasma.md","articles":[]},"dir":"ltr"},"config":{"plugins":["katex"],"styles":{"website":"css/index.css"},"pluginsConfig":{"fontSettings":{"theme":"sepia","family":"serif","size":1},"katex":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageBreaksBefore":"/","headerTemplate":null,"paperSize":"a4","margin":{"right":62,"left":62,"top":36,"bottom":36},"fontSize":12,"fontFamily":"Arial","footerTemplate":null,"chapterMark":"pagebreak","pageNumbers":false},"structure":{"langs":"LANGS.md","readme":"Introduction.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"isbn":"null","variables":{},"title":"Plasm Documentations","links":{"sidebar":{"Plasm":"https://github.com/stakedtechnologies/Plasm","Documentation(crates)":"http://crates.plasmnet.io","PlasmProject Whitepaper(en)":"https://github.com/stakedtechnologies/plasmdocs/blob/master/wp/en.pdf","PlasmProject Whitepaper(jp)":"https://github.com/stakedtechnologies/plasmdocs/blob/master/wp/jp.pdf","Telegram":"https://t.me/PlasmOfficial"},"sharing":{"google":true,"facebook":true,"twitter":true,"weibo":true,"all":true}},"gitbook":"*","description":null,"extension":null},"file":{"path":"TechnicalChapter/OVM.md","mtime":"2020-05-28T01:45:52.081Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-05-28T01:47:00.458Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

